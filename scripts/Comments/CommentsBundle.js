(()=>{"use strict";const t={fullName:void 0,emailAddress:void 0,emailVerified:void 0,id:void 0,profileImgColor:void 0};let e=localStorage.getItem("token");function n(){const t=document.querySelectorAll(".editLinkButton");t.length>0&&t.forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault(),o(t)}))}))}const o=t=>{var e;if(null!==t.closest(".comment")){let n=t.closest("div.comment-main").querySelector(".editComment");if(n&&"none"===n.style.display){t.innerText="Cancel Editing",n.style.display="block";const o=null===(e=t.closest("div.comment-main"))||void 0===e?void 0:e.querySelector("p");let i=o.innerText;i&&(t.closest("div.comment-header").insertAdjacentHTML("afterend",'\n                    <textarea \n                        name="commentTextarea" \n                        id="commentTextarea" \n                        minlength="3"\n                        maxlength="120"\n                        requiredminlength="3"\n\t\t\t\t\t\tmaxlength="120"\n\t\t\t\t\t\trequired\n                    ></textarea>\n                '),o.style.display="none"),t.closest("div.comment-main").querySelector("textarea").value=i}else{const e=t.closest("div.comment-main").querySelector("p");t.innerText="Edit Comment",e.style.display="block",t.closest("div.comment-main").querySelector("textarea").remove(),n.style.display="none"}}};n();var i=function(t,e,n,o){return new(n||(n=Promise))((function(i,a){function c(t){try{d(o.next(t))}catch(t){a(t)}}function l(t){try{d(o.throw(t))}catch(t){a(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}d((o=o.apply(t,e||[])).next())}))};const a="https://elliotapiserver.co.uk/Comments/vote";let c=localStorage.getItem("token");var l=function(t,e,n,o){return new(n||(n=Promise))((function(i,a){function c(t){try{d(o.next(t))}catch(t){a(t)}}function l(t){try{d(o.throw(t))}catch(t){a(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}d((o=o.apply(t,e||[])).next())}))};function d(){return l(this,void 0,void 0,(function*(){try{const t=yield fetch("https://elliotapiserver.co.uk/Comments?"+new URLSearchParams({stream:"633d4dbc76066edc99546269"}).toString(),{method:"GET",headers:{"Content-Type":"application/json"}});if(200!==t.status)throw new Error("Not Authenticated");{const e=yield t.json();e.length>0&&s(e)}}catch(t){}}))}localStorage.getItem("token");const s=e=>{const o=document.getElementById("InsertCommentsContainer");o&&(o.innerHTML="",e.forEach((e=>l(void 0,void 0,void 0,(function*(){console.log(t.fullName===e.fullname);let n=`\n        <div class="comment" data-commentId="${e.id}">\n        <div class="comment-main">\n            <div class="comment-header">\n                <div>\n                    <img src="../../../../img/logo-dark.png" alt="Profile Image" />\n                    <div class="CommentHeaderDot"></div>\n                    <h2>${e.fullname}</h2>\n                    <div class="CommentHeaderDot"></div>\n                    <span>${function(t){const e=new Date(t);var n=e.getDate(),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],i=e.getFullYear(),a=e.getHours(),c=e.getMinutes();return`${o} ${n<=9?"0"+n:n}, ${i} at ${a>=12?a-12:a}:${c<=9?"0"+c:c} ${a>=12&&c>0?"PM":"AM"}`}(new Date(e.time))}</span>\n                    <h3>${e.hasBeenEdited?"(Edited)":""}</h3>\n                </div>\n                <div>${t.fullName===e.fullname&&void 0!==t.fullName?'<button class="editLinkButton" tabindex="0">Edit Comment</button>':""}</div>\n            </div>\n            <p>\n                ${e.text}\n            </p>\n\t\t\t${t.fullName===e.fullname&&void 0!==t.fullName?'<div class="editComment" style="display: none">\n\t\t\t<button class="deleteLinkButton u-margin-top-small" tabindex="0">Delete Comment</button>\n\t\t\t<button class="publish">Publish</button>\n\t\t</div>':""}\n            \n        </div>\n        <div class="comment-side">\n            <button class="upvoteComment">\n                <i class="fa-solid fa-chevron-up green"></i>\n            </button>\n            <p>${e.upvotes}</p>\n            <div class="CommentHeaderDot"></div>\n            <p>${e.downvotes}</p>\n            <button class="downvoteComment">\n                <i class="fa-solid fa-chevron-down red"></i>\n            </button>\n        </div>\n    </div>\n        `;o.insertAdjacentHTML("afterbegin",n)})))),n(),function(){const t=document.querySelectorAll(".upvoteComment"),e=document.querySelectorAll(".downvoteComment");t.length>0&&t.forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault(),(t=>{i(void 0,void 0,void 0,(function*(){if(null!==t.closest(".comment")){let e=t.closest(".comment").dataset.commentid,n={token:c,id:e,votetype:"up"};try{200===(yield fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).status&&d()}catch(t){}}}))})(t)}))})),e.length>0&&e.forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault(),(t=>{i(void 0,void 0,void 0,(function*(){if(null!==t.closest(".comment")){let e=t.closest(".comment").dataset.commentid,n={token:c,id:e,votetype:"down"};try{200===(yield fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).status&&d()}catch(t){}}}))})(t)}))}))}())};const r=document.getElementById("publishCommentButton"),m=document.getElementById("commentStreamContainer"),u=document.getElementById("commentTextarea");let v=localStorage.getItem("token");!function(){var n,o,i,a;n=this,o=void 0,a=function*(){yield function(){return n=this,o=void 0,a=function*(){try{const n=yield fetch("https://elliotapiserver.co.uk/Auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(201!==n.status)throw new Error("Not Authenticated");{const e=yield n.json();t.fullName=e.data.fullName,t.emailAddress=e.data.emailAddress,t.emailVerified=e.data.emailVerified,t.id=e.data.id,t.profileImgColor=e.data.profileImgColor;const o=document.querySelector(".add-comment-container-notAllowed");null==o||o.classList.add("allowed")}}catch(t){}},new((i=void 0)||(i=Promise))((function(t,e){function c(t){try{d(a.next(t))}catch(t){e(t)}}function l(t){try{d(a.throw(t))}catch(t){e(t)}}function d(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(c,l)}d((a=a.apply(n,o||[])).next())}));var n,o,i,a}(),yield d(),function(){null==r||r.addEventListener("click",(t=>{return e=this,n=void 0,i=function*(){t.preventDefault();let e={token:v,text:u.value.toString(),stream:null==m?void 0:m.dataset.stream};try{201===(yield fetch("https://elliotapiserver.co.uk/Comments?"+new URLSearchParams({stream:"633d4dbc76066edc99546269"}).toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).status&&(d(),u.value="")}catch(t){}},new((o=void 0)||(o=Promise))((function(t,a){function c(t){try{d(i.next(t))}catch(t){a(t)}}function l(t){try{d(i.throw(t))}catch(t){a(t)}}function d(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(c,l)}d((i=i.apply(e,n||[])).next())}));var e,n,o,i}))}()},new((i=void 0)||(i=Promise))((function(t,e){function c(t){try{d(a.next(t))}catch(t){e(t)}}function l(t){try{d(a.throw(t))}catch(t){e(t)}}function d(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(c,l)}d((a=a.apply(n,o||[])).next())}))}()})();