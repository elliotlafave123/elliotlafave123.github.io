(()=>{"use strict";let t=localStorage.getItem("token");function e(){const t=document.querySelectorAll(".editLinkButton");t.length>0&&t.forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault(),n(t)}))}))}const n=t=>{var e;if(null!==t.closest(".comment")){let n=t.closest("div.comment-main").querySelector(".editComment");if(n&&"none"===n.style.display){t.innerText="Cancel Editing",n.style.display="block";const o=null===(e=t.closest("div.comment-main"))||void 0===e?void 0:e.querySelector("p");let i=o.innerText;i&&(t.closest("div.comment-header").insertAdjacentHTML("afterend",'\n                    <textarea \n                        name="commentTextarea" \n                        id="commentTextarea" \n                        minlength="3"\n                        maxlength="120"\n                        requiredminlength="3"\n\t\t\t\t\t\tmaxlength="120"\n\t\t\t\t\t\trequired\n                    ></textarea>\n                '),o.style.display="none"),t.closest("div.comment-main").querySelector("textarea").value=i}else{const e=t.closest("div.comment-main").querySelector("p");t.innerText="Edit Comment",e.style.display="block",t.closest("div.comment-main").querySelector("textarea").remove(),n.style.display="none"}}};e();var o=function(t,e,n,o){return new(n||(n=Promise))((function(i,c){function a(t){try{l(o.next(t))}catch(t){c(t)}}function r(t){try{l(o.throw(t))}catch(t){c(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}l((o=o.apply(t,e||[])).next())}))};const i="https://elliotapiserver.co.uk/Comments/vote";let c=localStorage.getItem("token");function a(){return t=this,e=void 0,o=function*(){try{const t=yield fetch("https://elliotapiserver.co.uk/Comments?"+new URLSearchParams({stream:"633d4dbc76066edc99546269"}).toString(),{method:"GET",headers:{"Content-Type":"application/json"}});if(200!==t.status)throw new Error("Not Authenticated");{const e=yield t.json();e.length>0&&r(e)}}catch(t){}},new((n=void 0)||(n=Promise))((function(i,c){function a(t){try{l(o.next(t))}catch(t){c(t)}}function r(t){try{l(o.throw(t))}catch(t){c(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}l((o=o.apply(t,e||[])).next())}));var t,e,n,o}const r=t=>{const n=document.getElementById("InsertCommentsContainer");n&&(n.innerHTML="",t.forEach((t=>{let e=`\n        <div class="comment" data-commentId="${t.id}">\n        <div class="comment-main">\n            <div class="comment-header">\n                <div>\n                    <img src="../../../../img/logo-dark.png" alt="Profile Image" />\n                    <div class="CommentHeaderDot"></div>\n                    <h2>${t.fullname}</h2>\n                    <div class="CommentHeaderDot"></div>\n                    <span>${function(t){const e=new Date(t);var n=e.getDate(),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],i=e.getFullYear(),c=e.getHours(),a=e.getMinutes();return`${o} ${n<=9?"0"+n:n}, ${i} at ${c}:${a} ${c>=12&&a>0?"PM":"AM"}`}(new Date(t.time))}</span>\n                    <h3>${t.hasBeenEdited?"(Edited)":""}</h3>\n                </div>\n                <div></div>\n            </div>\n            <p>\n                ${t.text}\n            </p>\n            \n        </div>\n        <div class="comment-side">\n            <button class="upvoteComment">\n                <i class="fa-solid fa-chevron-up green"></i>\n            </button>\n            <p>${t.upvotes}</p>\n            <div class="CommentHeaderDot"></div>\n            <p>${t.downvotes}</p>\n            <button class="downvoteComment">\n                <i class="fa-solid fa-chevron-down red"></i>\n            </button>\n        </div>\n    </div>\n        `;n.insertAdjacentHTML("afterbegin",e)})),e(),function(){const t=document.querySelectorAll(".upvoteComment"),e=document.querySelectorAll(".downvoteComment");t.length>0&&t.forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault(),(t=>{o(void 0,void 0,void 0,(function*(){if(null!==t.closest(".comment")){let e=t.closest(".comment").dataset.commentid,n={token:c,id:e,votetype:"up"};try{200===(yield fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).status&&a()}catch(t){}}}))})(t)}))})),e.length>0&&e.forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault(),(t=>{o(void 0,void 0,void 0,(function*(){if(null!==t.closest(".comment")){let e=t.closest(".comment").dataset.commentid,n={token:c,id:e,votetype:"down"};try{200===(yield fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).status&&a()}catch(t){}}}))})(t)}))}))}())};const l=document.getElementById("publishCommentButton"),s=document.getElementById("commentStreamContainer"),d=document.getElementById("commentTextarea");let m=localStorage.getItem("token");!function(){var e,n,o,i;e=this,n=void 0,i=function*(){yield function(){return e=this,n=void 0,i=function*(){try{if(201!==(yield fetch("https://elliotapiserver.co.uk/Auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})})).status)throw new Error("Not Authenticated");{const t=document.querySelector(".add-comment-container-notAllowed");null==t||t.classList.add("allowed")}}catch(t){}},new((o=void 0)||(o=Promise))((function(t,c){function a(t){try{l(i.next(t))}catch(t){c(t)}}function r(t){try{l(i.throw(t))}catch(t){c(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,r)}l((i=i.apply(e,n||[])).next())}));var e,n,o,i}(),yield a(),function(){null==l||l.addEventListener("click",(t=>{return e=this,n=void 0,i=function*(){t.preventDefault();let e={token:m,text:d.value.toString(),stream:null==s?void 0:s.dataset.stream};try{201===(yield fetch("https://elliotapiserver.co.uk/Comments?"+new URLSearchParams({stream:"633d4dbc76066edc99546269"}).toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).status&&(a(),d.value="")}catch(t){}},new((o=void 0)||(o=Promise))((function(t,c){function a(t){try{l(i.next(t))}catch(t){c(t)}}function r(t){try{l(i.throw(t))}catch(t){c(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,r)}l((i=i.apply(e,n||[])).next())}));var e,n,o,i}))}()},new((o=void 0)||(o=Promise))((function(t,c){function a(t){try{l(i.next(t))}catch(t){c(t)}}function r(t){try{l(i.throw(t))}catch(t){c(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,r)}l((i=i.apply(e,n||[])).next())}))}()})();