<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="shortcut icon" type="image/png" href="../../../../img/logo.png" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&family=Zen+Kaku+Gothic+New:wght@300;400;500;700;900&display=swap"
			rel="stylesheet"
		/>
		<script src="https://kit.fontawesome.com/873062b8ef.js" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="../../../../css/style.css" />
		<meta name="description" content="Elliot La Fave's personal website / portfolio. A collection of all my projects" />
		<meta name="keywords" content="Elliotlafave, Elliot, la, fave, web, design, cv, portfolio, projects, javascript, manchester" />
		<meta name="author" content="Elliot La Fave" />
		<link rel="shortcut icon" type="image/png" href="../../../../img/favicon.png" />

		<script defer src="../../../../scripts/DarkMode/darkmodeHome.js"></script>
		<script defer src="../../../../scripts/DarkMode/SetDarkMode.js"></script>
		<script defer src="../../../../scripts/currentYear.js"></script>
		<script defer src="../../../enlargeImage.js"></script>
		<script defer src="../../../../scripts/tooltip/tooltip.js"></script>
		<script defer src="../../../sidebar.js"></script>
		<script defer src="../../../../scripts/Accessibility/headerNavigationArrowKey.js"></script>
		<script defer src="../../../../scripts/Login/storeBackLink.js"></script>
		<script defer src="../../../../scripts/SiteFrontendTSBundle.js"></script>

		<title>Comments Section</title>
	</head>
	<body>
		<nav aria-label="Skip Links">
			<ul class="off-screen">
				<li>
					<a href="#navigation" class="skip-link"> Skip to Primary Navigation </a>
				</li>
				<li>
					<a href="#first-section" class="skip-link"> Skip to Primary Content </a>
				</li>
			</ul>
		</nav>
		<div class="signedInStrip" id="signedInStrip">
			<div>
				<p id="logOutButton">Log Out</p>
				<a href="../../../../account.html">Account Details</a>
			</div>
		</div>
		<div class="signedInStrip signedInStrip-warning" id="signedInStripWarning">
			<span>Please verify your email address</span>
			<div>
				<a href="../../../Login/verifyEmail.html">Verify email</a>
			</div>
		</div>
		<!-- --- Navigation --- -->
		<div class="navigation">
			<input type="checkbox" class="navigation__checkbox" id="navi-toggle" tabindex="-1" />
			<label for="navi-toggle" class="navigation__button"><span class="navigation__icon">&nbsp;</span></label>
			<div class="navigation__background">&nbsp;</div>

			<ul class="desktop__nav">
				<div class="logo">
					<a href="../../../../index.html" id="navigation"><img src="../../../../img/logo.png" alt="Logo" class="logo-img" /></a>
				</div>

				<div>
					<li class="desktop__nav-item deleteMobile">
						<div class="toggle-container">
							<img src="../../../../img/icons/icon-sun.svg" alt="sun icon" class="toggle-container-sun" />
							<div>
								<input type="checkbox" id="checkboxSlider" class="toggle" tabindex="-1" />
								<label for="checkboxSlider" class="label" tabindex="0">
									<div class="ball"></div>
								</label>
							</div>
							<img src="../../../../img/icons/icon-moon.svg" alt="moon icon" class="toggle-container-moon" />
						</div>
					</li>

					<li class="desktop__nav-item">
						<div class="link-wrapper">
							<a href="../../../../index.html" class="link hover-12"><p class="link-text">Home</p></a>
						</div>
					</li>
					<li class="desktop__nav-item">
						<div class="link-wrapper">
							<a href="../../../../CV.html" class="link hover-12"><p class="link-text">My CV</p></a>
						</div>
					</li>
					<li class="desktop__nav-item">
						<div class="link-wrapper">
							<a href="../../../../portfolio.html" class="link hover-12"><p class="link-text">Portfolio</p></a>
						</div>
					</li>
				</div>
			</ul>

			<nav class="navigation__nav">
				<ul class="navigation__list">
					<li class="navigation__item">
						<a href="../../../../index.html" class="navigation__link" tabindex="-1">Home</a>
					</li>
					<li class="navigation__item">
						<a href="contact-me.html" class="navigation__link" tabindex="-1">Contact Me</a>
					</li>
					<li class="navigation__item">
						<a href="../../../../CV.html" class="navigation__link" tabindex="-1">My CV</a>
					</li>
					<li class="navigation__item">
						<a href="../../../../portfolio.html" class="navigation__link" tabindex="-1">Portfolio</a>
					</li>
					<li class="navigation__item">
						<div class="toggle-container">
							<img src="../../../../img/icons/icon-sun.svg" alt="sun icon" class="toggle-container-sun" />
							<div>
								<input type="checkbox" id="checkboxSlider" class="toggle" tabindex="-1" />
								<label for="checkboxSlider" class="label">
									<div class="ball"></div>
								</label>
							</div>
							<img src="../../../../img/icons/icon-moon.svg" alt="moon icon" class="toggle-container-moon" />
						</div>
					</li>
				</ul>
			</nav>
		</div>

		<section class="logo mobile-only">
			<a href="../../../../index.html" tabindex="-1"
				><img src="../../../../img/logo.png" alt="Logo" class="logo-img mobile-only"
			/></a>
		</section>

		<a href="#top" class="btn-top"><i class="fa-solid fa-chevron-up"></i></a>

		<!-- --- Article --- -->
		<section class="article" role="top">
			<!-- Interactions -->
			<div class="article__interactions article__interactions-menu">
				<div class="breadcrumb"></div>
				<div class="article__interactions--section">
					<a href="../index.html" class="btn-square btn-square--back" id="first-section"
						><i class="fa-solid fa-arrow-left-long"></i>Back</a
					>
				</div>
			</div>

			<div class="article__grid">
				<div>
					<div class="article__header">
						<h2>Comments Section</h2>

						<div class="article__header-info">
							<span>Elliot La Fave</span>
							<p>&#183;</p>
							<span> 07/10/2022</span>
							<p>&#183;</p>
							<span>16:35pm</span>
						</div>
					</div>

					<div class="article__section" id="Idea">
						<h2>The Idea</h2>
						<p>
							Over the last week I have been on a course namely 'Website fundimentals' where we are learning the basics of
							HTML, CSS and JS.
						</p>
						<p>
							As I have previously learned most of the content for the first four days I decided to give myself a challange to
							complete over these days.
						</p>
						<p>In the past I had an idea to add a comments section to the articles on my website (like this one).</p>
					</div>

					<div class="article__section" id="Plan">
						<h2>My Plan</h2>
						<p>I created a list of features which would be required to complete the project:</p>
						<div class="article__user-story">
							<ul class="u-margin-bottom-medium">
								<li>Build login / sign up forms</li>
								<li>Create a 'signed in strip' so users know when they are logged in</li>
								<li>Design the look of a comment</li>
								<li>Email verification</li>
								<li>API to store and send comments</li>
							</ul>
						</div>
					</div>

					<div class="article__section" id="API">
						<h2>The API</h2>
						<p>For the API to be fully functional I needed to create the following endpoints:</p>
						<div class="article__user-story">
							<ul class="u-margin-bottom-medium">
								<li>Create comment stream</li>
								<li>GET all comments from stream</li>
								<li>POST a comment to a stream</li>
								<li>PUT - Edit a comment</li>
								<li>DELETE a comment</li>
								<li>Vote - up and down</li>
							</ul>
						</div>
					</div>

					<div class="article__section" id="UserLogin">
						<h2>Integrating user login</h2>
						<p>
							I had already created a user authentication API, it is used in this
							<a href="https://login.elliotlafave.com">user authentication app</a>.
						</p>
						<p>
							The app uses JWT (JSON web token) authentication. This works by creating a random token when a user successfully
							logs in. The token is saved n their browser and will allow them access for an amount of time until the token
							expires and they must log in again.
						</p>
						<p>
							I designed the pages and connected them to the API and it worked straight away, that would've been the most
							difficult part if I hadn't created the authentication API previously. The signed in state is below:
						</p>
						<div class="article__image">
							<img src="img/SignedInStrip.png" alt="Signed in strip" class="articleImg" />
							<p>Signed in strip</p>
						</div>
						<p>
							I then added a Google Recaptcha checkbox to prevent spam on my site, I also added states for when users are
							signed in but their email is not verified:
						</p>
						<div class="article__image">
							<img src="img/VerifyStrip.png" alt="Verify email strip" class="articleImg" />
							<p>Verify email strip</p>
						</div>
						<!--  -->
						<p>After logging in a user will be brought back to the page they started the login/sign up process from.</p>
						<p>The pages for the login/sign up pages are below:</p>
						<div class="article__user-story">
							<ul class="u-margin-bottom-medium">
								<li>Log In: <a href="../../../Login/login.html">Login</a></li>
								<li>Sign Up: <a href="../../../Login/signUp.html">Sign Up</a></li>
							</ul>
						</div>
					</div>

					<div class="article__section" id="CommentDesign">
						<h2>Comments Section Design</h2>
						<p>
							I first had to think about what data a comment would need. This would be the data model used by MongoDB and
							Typescript. The data model I settled with is below:
						</p>
						<div class="article__user-story">
							<ul class="u-margin-bottom-medium">
								<li>ID</li>
								<li>Text</li>
								<li>Full Name</li>
								<li>Time</li>
								<li>upvotes</li>
								<li>downvotes</li>
								<li>hasBeenEdited</li>
							</ul>
						</div>
						<p>I then created the markup for a comment and styled it using SCSS:</p>
						<div class="article__image">
							<img src="img/AComment.png" alt="A Comment" class="articleImg" />
							<p>A Comment</p>
						</div>
						<p>When a user is not signed in they will see this state:</p>
						<div class="article__image">
							<img src="img/CommentsLogIn.png" alt="Comments section login buttons" class="articleImg" />
							<p>Comments section login buttons</p>
						</div>
						<p>When a user is signed in, but their email is not verified they see this state:</p>
						<div class="article__image">
							<img src="img/CommentsVerify.png" alt="Comments section verify email" class="articleImg" />
							<p>Comments section verify email</p>
						</div>
						<p>All of the designs are responsive so they work on all devices.</p>
					</div>

					<div class="article__section" id="CommentAPI">
						<h2>The Comment API</h2>
						<p>For the API, I wrote the code using Express (A NodeJS library) and Mongoose (A MongoDB library).</p>
						<p>
							I added a folder into my API server repository and created all of the required endpoints, I used Postman to send
							requests to the API while developing it.
						</p>
						<p>All of the endpoints use the JWT token to ensure that only verified users can comment.</p>
						<div class="article__image article__image-thin">
							<img src="img/PostmanEndpoints.png" alt="Comments API Endpoints in Postman" class="articleImg" />
							<p>Comments API Endpoints in Postman</p>
						</div>
						<p>
							The API is running on a <a href="https://www.linode.com/">Linode</a> cloud based server. I have configured the
							server to use HTTPS and with the E-Mail ports allowed so I can send email verification codes to users.
						</p>
						<p>
							The database is running on a <a href="https://www.mongodb.com/atlas/database">MongoDB Atlas Cloud</a> which is a
							free service up to a certain amount of traffic or data stored.
						</p>
					</div>

					<div class="article__section">
						<div id="CommentTS">
							<h2>The Frontend Logic</h2>
							<p>
								For the rendering of comments along with the user interface interactions, I chose to go with TypeScript
								(TS). I find TS to be less error prone and easier to code with due to the in editor error checking.
							</p>
							<p>
								I wrote logic to call the GET all on stream endpoint, then it will use the data and render it to the page
								using the JS 'InsertAdjacentHTML' method.
							</p>

							<p>
								Each rendered comment has an ID added to the DataSet property, this is used when editing or deleting a
								comment.
							</p>
						</div>
						<p>Users can click the edit button on their comment if they are logged in which changes the look of the comment:</p>
						<div class="article__image">
							<img src="img/Editing.png" alt="Editing state of a comment" class="articleImg" />
							<p>Editing state of a comment</p>
						</div>
						<p>When editing users can use the DELETE endpoint and the PUT (update) endpoint.</p>
						<p>If a user is signed in and their email is verified they see the comment input box:</p>
						<div class="article__image">
							<img src="img/CommentInputSignedIn.png" alt="Unlocked comment input textarea" class="articleImg" />
							<p>Unlocked comment input textarea</p>
						</div>
						<h3>You can try it out below...</h3>
					</div>
				</div>

				<nav role="navigation" aria-label="Article Navigation" class="article__sidebar hide-mobile">
					<ol>
						<li><a href="#Idea">The Idea</a></li>
						<li><a href="#Plan">My Plan</a></li>
						<li><a href="#API">The API</a></li>
						<li><a href="#UserLogin">User Login</a></li>
						<li><a href="#CommentDesign">Comment Section Design</a></li>
						<li><a href="#CommentAPI">The Comment API</a></li>
						<li><a href="#CommentTS">Frontend Logic</a></li>
						<!-- <li>
							<a href="#Endpoints">Endpoints</a>
							<ul>
								<li class=""><a href="#Endpoints--all">Get all</a></li>
								<li class=""><a href="#Endpoints--name">Get by name</a></li>
								<li class=""><a href="#Endpoints--date">Get by date range</a></li>
							</ul>
						</li> -->
					</ol>
				</nav>
			</div>
		</section>
		<!-- Comments Section -->
		<section class="comments-container" data-stream="634003dea85c3632d4597efd" id="commentStreamContainer">
			<h2 id="comments">Comments</h2>
			<div>
				<form class="add-comment-container" onsubmit="return false">
					<div class="add-comment-container-notAllowed">
						<a id="logInButton" class="btn btn-purple-small storeBackLink" href="../../../Login/login.html">Log In</a>
						<a id="signUpButton" class="btn btn-purple-small storeBackLink" href="../../../Login/signUp.html">Sign Up</a>
						<a
							id="verifyEmailButton"
							class="btn btn-purple-small btn-purple-small-warning storeBackLink"
							href="../../../Login/verifyEmail.html"
							>Verify Email</a
						>
					</div>
					<label for="commentTextarea">Enter your comment...</label>
					<textarea
						placeholder="Type your comment in here..."
						name="commentTextarea"
						id="commentTextarea"
						minlength="3"
						maxlength="120"
						required
					></textarea>
					<input type="submit" value="Publish" id="publishCommentButton" />
				</form>
			</div>
			<div id="InsertCommentsContainer"></div>
		</section>
		<!-- --- Footer --- -->
		<section class="contact u-margin-top-large">
			<img src="../../../../img/contact.png" alt="" class="contact__img" />
			<h3 class="skills__header u-margin-bottom-large" id="contactme">Contact Me</h3>
			<div class="contact__form">
				<form
					name="contact"
					method="POST"
					data-netlify="true"
					class="form"
					id="form-contact"
					action="../../pages/success/index.html"
					netlify
				>
					<div class="form__group">
						<input type="text" class="form__input form__input-small" placeholder="Full name" id="name" name="name" required />
						<label for="name" class="form__label">Full name</label>
					</div>

					<div class="form__group">
						<input
							type="email"
							class="form__input form__input-small"
							placeholder="Email address"
							id="email"
							name="email"
							required
						/>
						<label for="email" class="form__label">Email address</label>
					</div>

					<div class="form__group">
						<label for="message" class="form__label u-margin-bottom-small">Your message</label>
						<textarea
							class="form__input form__input-textarea"
							id="message"
							rows="8"
							form="form-contact"
							name="message"
							required
						></textarea>
					</div>

					<button class="btn btn-purple-post u-margin-top-small" type="submit">Send Message! &nbsp; &rarr;</button>
				</form>
			</div>
		</section>

		<div class="wave-top">
			<img src="../../../../img/wave5.png" alt="" class="wave-bottom__img" id="wave5-dark" />
			<img src="../../../../img/wave5-light.png" alt="" class="wave-top__img hidden" id="wave5-light" />
		</div>

		<footer class="footer">
			<div class="footer__logo">
				<a href="../../../../index.html"><img src="../../../../img/logo.png" alt="Footer Logo" /></a>
			</div>
			<ul class="footer__nav">
				<li class="footer__nav-item">
					<a href="#contactme">Contact Me</a>
				</li>
				<li class="footer__nav-item">
					<a href="../../../../CV.html">CV</a>
				</li>
				<li class="footer__nav-item">
					<a href="../../../../portfolio.html">Portfolio</a>
				</li>
			</ul>
			<div class="footer__icons">
				<a href="https://www.linkedin.com/in/elliot-la-fave-4215b6222/?locale=es_ES" target="blank"
					><img src="../../../../img/linkedin-brands.svg" alt="Linkedin Logo"
				/></a>
				<a href="https://github.com/elliotlafave123/elliotlafave123.github.io"
					><img src="../../../../img/github-brands.svg" alt="GitHub Logo" target="blank"
				/></a>
				<a href="https://codepen.io/elliotlafave123" target="_blank"
					><img src="../../../../img/codepen-brands.svg" alt="Codepen Logo"
				/></a>
			</div>
			<p class="footer__paragraph">Designed and coded by Elliot La Fave using SCSS, JS, NodeJS and MongoDB.</p>
			<p class="footer__paragraph">Copyright © Elliot La Fave <span id="currentYear">0000</span>.</p>
		</footer>
	</body>
</html>
